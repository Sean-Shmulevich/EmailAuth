import{S as Me,i as Pe,s as Ee,k as B,a as Fe,l as R,m as ce,c as De,h as I,n as w,_ as $,p as P,b as he,W as ee,J as A,aa as X,X as te,R as Ae,a5 as Le,o as Ze,ab as be,ac as Ie,ad as b,w as ne}from"./index.5c233941.js";function ie(i,e,n){return i>=e*n?{width:e*n,height:e}:{width:i,height:i/n}}function Y(i,e,n,s){return{x:oe(i.x,e.width,n.width,s),y:oe(i.y,e.height,n.height,s)}}function oe(i,e,n,s){const r=e*s/2-n/2;return Math.min(r,Math.max(i,-r))}function se(i,e){return Math.sqrt(Math.pow(i.y-e.y,2)+Math.pow(i.x-e.x,2))}function Te(i,e,n,s,r,h=!0){const l=h?Se:ke,o={x:l(100,((e.width-n.width/r)/2-i.x/r)/e.width*100),y:l(100,((e.height-n.height/r)/2-i.y/r)/e.height*100),width:l(100,n.width/e.width*100/r),height:l(100,n.height/e.height*100/r)},c=l(e.naturalWidth,o.width*e.naturalWidth/100,!0),a=l(e.naturalHeight,o.height*e.naturalHeight/100,!0),v=e.naturalWidth>=e.naturalHeight*s?{width:Math.round(a*s),height:a}:{width:c,height:Math.round(c/s)},F={...v,x:l(e.naturalWidth-v.width,o.x*e.naturalWidth/100,!0),y:l(e.naturalHeight-v.height,o.y*e.naturalHeight/100,!0)};return{croppedAreaPercentages:o,croppedAreaPixels:F}}function Se(i,e,n=!1){const s=n?Math.round(e):e;return Math.min(i,Math.max(0,s))}function ke(i,e){return e}function re(i,e){return{x:(e.x+i.x)/2,y:(e.y+i.y)/2}}const{window:Ce}=Ie;function ae(i){let e;return{c(){e=B("div"),this.h()},l(n){e=R(n,"DIV",{class:!0,style:!0,"data-testid":!0}),ce(e).forEach(I),this.h()},h(){w(e,"class","cropperArea svelte-12kodkg"),P(e,"width",i[7].width+"px"),P(e,"height",i[7].height+"px"),w(e,"data-testid","cropper"),b(e,"round",i[3]==="round"),b(e,"grid",i[4])},m(n,s){he(n,e,s)},p(n,s){s[0]&128&&P(e,"width",n[7].width+"px"),s[0]&128&&P(e,"height",n[7].height+"px"),s[0]&8&&b(e,"round",n[3]==="round"),s[0]&16&&b(e,"grid",n[4])},d(n){n&&I(e)}}}function We(i){let e,n,s,r,h,l,o=i[7]&&ae(i);return{c(){e=B("div"),n=B("img"),r=Fe(),o&&o.c(),this.h()},l(c){e=R(c,"DIV",{class:!0,"data-testid":!0});var a=ce(e);n=R(a,"IMG",{class:!0,src:!0,alt:!0,style:!0,crossorigin:!0}),r=De(a),o&&o.l(a),a.forEach(I),this.h()},h(){w(n,"class","image svelte-12kodkg"),$(n.src,s=i[2])||w(n,"src",s),w(n,"alt",""),P(n,"transform","translate("+i[1].x+"px, "+i[1].y+"px) scale("+i[0]+")"),w(n,"crossorigin",i[5]),w(e,"class","container svelte-12kodkg"),w(e,"data-testid","container")},m(c,a){he(c,e,a),ee(e,n),i[20](n),ee(e,r),o&&o.m(e,null),i[21](e),h||(l=[A(Ce,"resize",i[10]),A(n,"load",i[9]),A(e,"mousedown",X(i[11])),A(e,"touchstart",X(i[12])),A(e,"wheel",X(i[13]))],h=!0)},p(c,a){a[0]&4&&!$(n.src,s=c[2])&&w(n,"src",s),a[0]&3&&P(n,"transform","translate("+c[1].x+"px, "+c[1].y+"px) scale("+c[0]+")"),a[0]&32&&w(n,"crossorigin",c[5]),c[7]?o?o.p(c,a):(o=ae(c),o.c(),o.m(e,null)):o&&(o.d(1),o=null)},i:te,o:te,d(c){c&&I(e),i[20](null),o&&o.d(),i[21](null),h=!1,Ae(l)}}}function He(i,e,n){let{image:s}=e,{crop:r={x:0,y:0}}=e,{zoom:h=1}=e,{aspect:l=4/3}=e,{minZoom:o=1}=e,{maxZoom:c=3}=e,{cropSize:a=null}=e,{cropShape:T="rect"}=e,{showGrid:v=!0}=e,{zoomSpeed:F=1}=e,{crossOrigin:z=null}=e,{restrictPosition:_=!0}=e,f=null,D={width:0,height:0,naturalWidth:0,naturalHeight:0},g=null,p=null,d=null,S={x:0,y:0},k={x:0,y:0},C=0,W=null,H=null;const ue=Le();Ze(()=>{d&&d.complete&&J(),g&&(g.addEventListener("gesturestart",L),g.addEventListener("gesturechange",L))}),be(()=>{g&&(g.removeEventListener("gesturestart",L),g.removeEventListener("gesturechange",L)),V()});const L=t=>t.preventDefault(),V=()=>{typeof document<"u"&&(document.removeEventListener("mousemove",K),document.removeEventListener("mouseup",Z),document.removeEventListener("touchmove",Q),document.removeEventListener("touchend",Z))},J=()=>{j(),G()},le=()=>a?a.width/a.height:l,j=()=>{d&&(D={width:d.width,height:d.height,naturalWidth:d.naturalWidth,naturalHeight:d.naturalHeight},n(7,f=a||ie(d.width,d.height,l))),g&&(p=g.getBoundingClientRect())},N=t=>({x:Number(t.clientX),y:Number(t.clientY)}),M=t=>({x:Number(t.clientX),y:Number(t.clientY)}),de=t=>{document.addEventListener("mousemove",K),document.addEventListener("mouseup",Z),q(N(t))},K=t=>O(N(t)),me=t=>{document.addEventListener("touchmove",Q,{passive:!1}),document.addEventListener("touchend",Z),t.touches.length===2?fe(t):t.touches.length===1&&q(M(t.touches[0]))},Q=t=>{t.preventDefault(),t.touches.length===2?ge(t):t.touches.length===1&&O(M(t.touches[0]))},q=({x:t,y:u})=>{S={x:t,y:u},k={x:r.x,y:r.y}},O=({x:t,y:u})=>{W&&window.cancelAnimationFrame(W),W=window.requestAnimationFrame(()=>{if(t===void 0||u===void 0||!f)return;const m=t-S.x,x=u-S.y,y={x:k.x+m,y:k.y+x};n(1,r=_?Y(y,D,f,h):y)})},Z=()=>{V(),G()},fe=t=>{const u=M(t.touches[0]),m=M(t.touches[1]);C=se(u,m),q(re(u,m))},ge=t=>{const u=M(t.touches[0]),m=M(t.touches[1]),x=re(u,m);O(x),H&&window.cancelAnimationFrame(H),H=window.requestAnimationFrame(()=>{const y=se(u,m),pe=h*(y/C);U(pe,x),C=y})},we=t=>{const u=N(t),m=h-t.deltaY*F/200;U(m,u)},ye=({x:t,y:u})=>{if(!p)throw new Error("The Cropper is not mounted");return{x:p.width/2-(t-p.left),y:p.height/2-(u-p.top)}},xe=({x:t,y:u})=>({x:(t+r.x)/h,y:(u+r.y)/h}),U=(t,u)=>{if(!f)return;const m=ye(u),x=xe(m);n(0,h=Math.min(c,Math.max(t,o)));const y={x:x.x*h-m.x,y:x.y*h-m.y};n(1,r=_?Y(y,D,f,h):y)},G=()=>{if(!f||f.width===0)return;const t=_?Y(r,D,f,h):r,{croppedAreaPercentages:u,croppedAreaPixels:m}=Te(t,D,f,le(),h,_);ue("cropcomplete",{percent:u,pixels:m})};function ve(t){ne[t?"unshift":"push"](()=>{d=t,n(6,d)})}function _e(t){ne[t?"unshift":"push"](()=>{g=t,n(8,g)})}return i.$$set=t=>{"image"in t&&n(2,s=t.image),"crop"in t&&n(1,r=t.crop),"zoom"in t&&n(0,h=t.zoom),"aspect"in t&&n(14,l=t.aspect),"minZoom"in t&&n(15,o=t.minZoom),"maxZoom"in t&&n(16,c=t.maxZoom),"cropSize"in t&&n(17,a=t.cropSize),"cropShape"in t&&n(3,T=t.cropShape),"showGrid"in t&&n(4,v=t.showGrid),"zoomSpeed"in t&&n(18,F=t.zoomSpeed),"crossOrigin"in t&&n(5,z=t.crossOrigin),"restrictPosition"in t&&n(19,_=t.restrictPosition)},i.$$.update=()=>{i.$$.dirty[0]&147520&&d&&n(7,f=a||ie(d.width,d.height,l)),i.$$.dirty[0]&1&&h&&G()},[h,r,s,T,v,z,d,f,g,J,j,de,me,we,l,o,c,a,F,_,ve,_e]}class qe extends Me{constructor(e){super(),Pe(this,e,He,We,Ee,{image:2,crop:1,zoom:0,aspect:14,minZoom:15,maxZoom:16,cropSize:17,cropShape:3,showGrid:4,zoomSpeed:18,crossOrigin:5,restrictPosition:19},null,[-1,-1])}}var E;(function(i){i[i.InvalidFileType=0]="InvalidFileType",i[i.FileSizeMaximumExceeded=1]="FileSizeMaximumExceeded",i[i.FileSizeMinimumNotMet=2]="FileSizeMinimumNotMet",i[i.FileCountExceeded=3]="FileCountExceeded"})(E||(E={}));E.InvalidFileType+"",E.FileCountExceeded+"",E.FileSizeMinimumNotMet+"",E.FileSizeMaximumExceeded+"";export{qe as C};

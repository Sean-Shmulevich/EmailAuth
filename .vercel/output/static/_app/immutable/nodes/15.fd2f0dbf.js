import{S as le,i as ne,s as B,k as g,a as x,q as N,l as w,c as E,m as y,r as L,h as d,n as m,b as M,W as f,X as U,a9 as ie,o as re,J as Y,R as oe,u as ae,_ as G,e as F,d as X,f as ce,g as z,w as j,a2 as A,y as fe,z as ue,A as de,a3 as q,B as he,v as me}from"../chunks/index.5c233941.js";console.log("hello ");const ve=c=>{const t=_=>(_.preventDefault(),{x:_.clientX,y:_.clientY}),i=_=>(_.preventDefault(),{x:_.changedTouches[0].clientX,y:_.changedTouches[0].clientY});let r=document.querySelectorAll(".boxcontent"),s=Rx.Observable.fromEvent(r,"mousedown").map(t),n=Rx.Observable.fromEvent(window,"mousemove").map(t),o=Rx.Observable.fromEvent(window,"mouseup").map(t),h=Rx.Observable.fromEvent(r,"touchstart").map(i),u=Rx.Observable.fromEvent(r,"touchmove").map(i),p=Rx.Observable.fromEvent(window,"touchend").map(i),e=s.merge(h),l=n.merge(u),v=o.merge(p),a=e.concatMap(_=>l.takeUntil(v).map(b=>{const I=b.x-_.x,k=b.y-_.y;return{x:I,y:k}})),D=e.concatMap(_=>v.first().map(b=>{const I=b.x-_.x,k=b.y-_.y;return{x:I,y:k}}));e.forEach(()=>{$(".boxcontent").last().css({transition:"initial",cursor:"grabbing"}),$(".like").last().css({transition:"initial"}),$(".nope").last().css({transition:"initial"})}),a.forEach(_=>{$(".boxcontent").last().css({left:_.x,top:_.y,transform:"rotate("+-_.x/20+"deg)"}),$(".box:nth-last-of-type(2) .boxcontent").css({width:Math.min(100,90+Math.abs(_.x)/200*10)+"%",height:Math.min(100,90+Math.abs(_.x)/200*10)+"%",margin:Math.max(0,(1-Math.abs(_.x)/200)*5)+"%"}),$(".like").last().css({opacity:_.x/200}),$(".nope").last().css({opacity:-_.x/200})}),D.forEach(_=>{_.x>130?(V(),c("liked")):_.x<-130?(P(),c("disliked")):R()});function V(){$(".box:last .boxcontent").css({transition:"left 0.5s",left:500}),setTimeout(()=>{$(".box").last().remove()},500)}function P(){$(".boxcontent").last().css({transition:"left 0.5s",left:-500}),setTimeout(()=>{$(".box").last().remove()},500)}function R(){const _=$(".box:last .boxcontent");_.css({transition:"left 0.5s, top 0.5s, transform 0.5s",left:0,top:0,transform:"rotate(0deg)"}),_.find(".like").css({transition:"opacity 0.5s",opacity:0}),_.find(".nope").css({transition:"opacity 0.5s",opacity:0})}document.querySelectorAll(".boxcontent").forEach(_=>{_.addEventListener("touchstart",b=>{b.preventDefault()})})};function H(c,t,i){const r=c.slice();return r[8]=t[i],r}function K(c){let t,i,r=c[8].id+"",s;return{c(){t=g("div"),i=g("p"),s=N(r),this.h()},l(n){t=w(n,"DIV",{class:!0});var o=y(t);i=w(o,"P",{});var h=y(i);s=L(h,r),h.forEach(d),o.forEach(d),this.h()},h(){m(t,"class","w-full text=center")},m(n,o){M(n,t,o),f(t,i),f(i,s)},p(n,o){o&1&&r!==(r=n[8].id+"")&&ae(s,r)},d(n){n&&d(t)}}}function Q(c){let t,i,r,s,n,o,h,u,p;return{c(){t=g("img"),r=x(),s=g("div"),n=g("div"),o=N("Влад, 20"),h=x(),u=g("div"),p=N("1 Common Interest"),this.h()},l(e){t=w(e,"IMG",{src:!0,alt:!0,class:!0}),r=E(e),s=w(e,"DIV",{class:!0});var l=y(s);n=w(l,"DIV",{class:!0});var v=y(n);o=L(v,"Влад, 20"),v.forEach(d),h=E(l),u=w(l,"DIV",{class:!0});var a=y(u);p=L(a,"1 Common Interest"),a.forEach(d),l.forEach(d),this.h()},h(){G(t.src,i="https://www.3dwiggle.com/wp-content/uploads/2016/06/hiroshi-yoshinaga-wired-lathyrus-blog-3dwiggle-1.gif")||m(t,"src",i),m(t,"alt","Profile picture"),m(t,"class","svelte-u19nne"),m(n,"class","name svelte-u19nne"),m(u,"class","interest"),m(s,"class","info svelte-u19nne")},m(e,l){M(e,t,l),M(e,r,l),M(e,s,l),f(s,n),f(n,o),f(s,h),f(s,u),f(u,p)},d(e){e&&d(t),e&&d(r),e&&d(s)}}}function Z(c){let t,i,r,s,n,o,h,u,p;return{c(){t=g("img"),r=x(),s=g("div"),n=g("div"),o=N("Влад, 20"),h=x(),u=g("div"),p=N("2 Common Interest"),this.h()},l(e){t=w(e,"IMG",{src:!0,alt:!0,class:!0}),r=E(e),s=w(e,"DIV",{class:!0});var l=y(s);n=w(l,"DIV",{class:!0});var v=y(n);o=L(v,"Влад, 20"),v.forEach(d),h=E(l),u=w(l,"DIV",{class:!0});var a=y(u);p=L(a,"2 Common Interest"),a.forEach(d),l.forEach(d),this.h()},h(){G(t.src,i="https://www.3dwiggle.com/wp-content/uploads/2016/06/hiroshi-yoshinaga-wired-lathyrus-blog-3dwiggle-1.gif")||m(t,"src",i),m(t,"alt","Profile picture"),m(t,"class","svelte-u19nne"),m(n,"class","name svelte-u19nne"),m(u,"class","interest"),m(s,"class","info svelte-u19nne")},m(e,l){M(e,t,l),M(e,r,l),M(e,s,l),f(s,n),f(n,o),f(s,h),f(s,u),f(u,p)},d(e){e&&d(t),e&&d(r),e&&d(s)}}}function ee(c){let t,i,r,s,n,o,h,u,p;return{c(){t=g("img"),r=x(),s=g("div"),n=g("div"),o=N("Влад, 20"),h=x(),u=g("div"),p=N("3 Common Interest"),this.h()},l(e){t=w(e,"IMG",{src:!0,alt:!0,class:!0}),r=E(e),s=w(e,"DIV",{class:!0});var l=y(s);n=w(l,"DIV",{class:!0});var v=y(n);o=L(v,"Влад, 20"),v.forEach(d),h=E(l),u=w(l,"DIV",{class:!0});var a=y(u);p=L(a,"3 Common Interest"),a.forEach(d),l.forEach(d),this.h()},h(){G(t.src,i="https://www.3dwiggle.com/wp-content/uploads/2016/06/hiroshi-yoshinaga-wired-lathyrus-blog-3dwiggle-1.gif")||m(t,"src",i),m(t,"alt","Profile picture"),m(t,"class","svelte-u19nne"),m(n,"class","name svelte-u19nne"),m(u,"class","interest"),m(s,"class","info svelte-u19nne")},m(e,l){M(e,t,l),M(e,r,l),M(e,s,l),f(s,n),f(n,o),f(s,h),f(s,u),f(u,p)},d(e){e&&d(t),e&&d(r),e&&d(s)}}}function te(c){let t,i,r,s,n,o,h,u,p,e,l,v,a,D,V,P,R,_,b=c[1]===0&&K(c),I=c[1]===1&&Q(),k=c[1]===2&&Z(),C=c[1]===3&&ee();return{c(){t=g("div"),i=g("div"),b&&b.c(),r=x(),I&&I.c(),s=x(),k&&k.c(),n=x(),C&&C.c(),o=x(),h=g("div"),u=N("Like"),p=x(),e=g("div"),l=N("Nope"),v=x(),a=g("button"),D=x(),V=g("button"),P=x(),this.h()},l(S){t=w(S,"DIV",{class:!0});var O=y(t);i=w(O,"DIV",{class:!0});var T=y(i);b&&b.l(T),r=E(T),I&&I.l(T),s=E(T),k&&k.l(T),n=E(T),C&&C.l(T),o=E(T),h=w(T,"DIV",{class:!0});var J=y(h);u=L(J,"Like"),J.forEach(d),p=E(T),e=w(T,"DIV",{class:!0});var W=y(e);l=L(W,"Nope"),W.forEach(d),T.forEach(d),v=E(O),a=w(O,"BUTTON",{class:!0,style:!0}),y(a).forEach(d),D=E(O),V=w(O,"BUTTON",{class:!0,style:!0}),y(V).forEach(d),P=E(O),O.forEach(d),this.h()},h(){m(h,"class","like svelte-u19nne"),m(e,"class","nope svelte-u19nne"),m(i,"class","boxcontent svelte-u19nne"),m(a,"class","hover:bg-white rounded-2xl absolute left-0 mt-6 w-10 h-[95%] opacity-20 z-10"),m(a,"style",""),m(V,"class","hover:bg-white rounded-2xl absolute right-0 mt-6 w-10 h-[95%] opacity-20 z-12"),m(V,"style",""),m(t,"class","box svelte-u19nne")},m(S,O){M(S,t,O),f(t,i),b&&b.m(i,null),f(i,r),I&&I.m(i,null),f(i,s),k&&k.m(i,null),f(i,n),C&&C.m(i,null),f(i,o),f(i,h),f(h,u),f(i,p),f(i,e),f(e,l),f(t,v),f(t,a),f(t,D),f(t,V),f(t,P),R||(_=[Y(a,"click",c[4]),Y(V,"click",c[5])],R=!0)},p(S,O){S[1]===0?b?b.p(S,O):(b=K(S),b.c(),b.m(i,r)):b&&(b.d(1),b=null),S[1]===1?I||(I=Q(),I.c(),I.m(i,s)):I&&(I.d(1),I=null),S[1]===2?k||(k=Z(),k.c(),k.m(i,n)):k&&(k.d(1),k=null),S[1]===3?C||(C=ee(),C.c(),C.m(i,o)):C&&(C.d(1),C=null)},d(S){S&&d(t),b&&b.d(),I&&I.d(),k&&k.d(),C&&C.d(),R=!1,oe(_)}}}function _e(c){let t,i,r,s,n,o,h,u,p=c[0],e=[];for(let l=0;l<p.length;l+=1)e[l]=te(H(c,p,l));return{c(){t=g("meta"),i=x(),r=g("div"),s=g("div"),n=g("div"),o=g("div"),h=N("Made by @app1e.jews"),u=x();for(let l=0;l<e.length;l+=1)e[l].c();this.h()},l(l){t=w(l,"META",{name:!0,content:!0}),i=E(l),r=w(l,"DIV",{id:!0,class:!0});var v=y(r);s=w(v,"DIV",{id:!0,class:!0});var a=y(s);n=w(a,"DIV",{class:!0});var D=y(n);o=w(D,"DIV",{class:!0});var V=y(o);h=L(V,"Made by @app1e.jews"),V.forEach(d),D.forEach(d),u=E(a);for(let P=0;P<e.length;P+=1)e[P].l(a);a.forEach(d),v.forEach(d),this.h()},h(){m(t,"name","viewport"),m(t,"content","width=device-width, initial-scale=1.0"),m(o,"class","label svelte-u19nne"),m(n,"class","background svelte-u19nne"),m(s,"id","container"),m(s,"class","svelte-u19nne"),m(r,"id","wrapper"),m(r,"class","svelte-u19nne")},m(l,v){M(l,t,v),M(l,i,v),M(l,r,v),f(r,s),f(s,n),f(n,o),f(o,h),f(s,u);for(let a=0;a<e.length;a+=1)e[a]&&e[a].m(s,null)},p(l,[v]){if(v&3){p=l[0];let a;for(a=0;a<p.length;a+=1){const D=H(l,p,a);e[a]?e[a].p(D,v):(e[a]=te(D),e[a].c(),e[a].m(s,null))}for(;a<e.length;a+=1)e[a].d(1);e.length=p.length}},i:U,o:U,d(l){l&&d(t),l&&d(i),l&&d(r),ie(e,l)}}}let pe=4;async function be(c){return await(await fetch("/deals",{method:"POST",body:c,headers:{"content-type":"application/json"}})).json()}function ge(c,t,i){let{offers:r}=t,s=[],n=0,{currDealIds:o}=t,{refreshCounter:h}=t,u=async l=>{if(s.push(l),console.log(s,s.length-1),s.length-1===pe){let v=[];for(let D=0;D<o.length;D++){let V={dealId:o[D],decision:s[D]};v.push(V)}s=[],i(2,o=[]),console.log(v);let a=await be(JSON.stringify(v));//!!! this makes it more seamless by loading in the last deal and running
console.log(a),i(0,r=[...a]),i(3,h+=1)}};re(async()=>{ve(u)});const p=()=>{i(1,n=n-1),n<0&&i(1,n=3)},e=()=>{i(1,n=n+1),n>3&&i(1,n=0)};return c.$$set=l=>{"offers"in l&&i(0,r=l.offers),"currDealIds"in l&&i(2,o=l.currDealIds),"refreshCounter"in l&&i(3,h=l.refreshCounter)},c.$$.update=()=>{if(c.$$.dirty&1)for(let l=0;l<r.length;l++)i(2,o[l]=r[l].id,o)},[r,n,o,h,p,e]}class we extends le{constructor(t){super(),ne(this,t,ge,_e,B,{offers:0,currDealIds:2,refreshCounter:3})}}function se(c){let t,i,r,s,n;function o(e){c[4](e)}function h(e){c[5](e)}function u(e){c[6](e)}let p={};return c[1]!==void 0&&(p.refreshCounter=c[1]),c[0]!==void 0&&(p.offers=c[0]),c[2]!==void 0&&(p.currDealIds=c[2]),t=new we({props:p}),j.push(()=>A(t,"refreshCounter",o)),j.push(()=>A(t,"offers",h)),j.push(()=>A(t,"currDealIds",u)),{c(){fe(t.$$.fragment)},l(e){ue(t.$$.fragment,e)},m(e,l){de(t,e,l),n=!0},p(e,l){const v={};!i&&l&2&&(i=!0,v.refreshCounter=e[1],q(()=>i=!1)),!r&&l&1&&(r=!0,v.offers=e[0],q(()=>r=!1)),!s&&l&4&&(s=!0,v.currDealIds=e[2],q(()=>s=!1)),t.$set(v)},i(e){n||(z(t.$$.fragment,e),n=!0)},o(e){X(t.$$.fragment,e),n=!1},d(e){he(t,e)}}}function ye(c){let t=c[1],i,r,s=se(c);return{c(){s.c(),i=F()},l(n){s.l(n),i=F()},m(n,o){s.m(n,o),M(n,i,o),r=!0},p(n,[o]){o&2&&B(t,t=n[1])?(me(),X(s,1,1,U),ce(),s=se(n),s.c(),z(s,1),s.m(i.parentNode,i)):s.p(n,o)},i(n){r||(z(s),r=!0)},o(n){X(s),r=!1},d(n){n&&d(i),s.d(n)}}}function Ie(c,t,i){let{data:r}=t,s=r.nextDeals,n=0,o=[];function h(e){n=e,i(1,n)}function u(e){s=e,i(0,s)}function p(e){o=e,i(2,o)}return c.$$set=e=>{"data"in e&&i(3,r=e.data)},[s,n,o,r,h,u,p]}class De extends le{constructor(t){super(),ne(this,t,Ie,ye,B,{data:3})}}export{De as component};
